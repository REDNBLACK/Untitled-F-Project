# F Project
[TOC]

##Схема работы

###Парсинг

Поднимаются воркеры по шедулеру (один воркер - одна служба доставки), задача воркера:

1. Распарсить все блюда (используя данные из RDB) и поместить в индекс эластика.
2. Распарсить ссылки на картинки на блюда (если есть), скачать и поместить в кассандру


###API

Используется REST API.

####SearchAPI
Используется для поиска "случайных" блюд с параметрами

#####Параметры запроса
* Город (пока только питер захардкодим)
* Район (местоположение вручную или через google api)
* Провайдер доставки (любой по умолчанию либо конкретный) (реализация будет пока только с fasteda.ru)
* Тип кухни (одна, множество либо любой по умолчанию) либо конкретный ресторан из списка либо быстрые фильтры - я веган/я спортсмен/я мусульманин)
* Количество персон (по умолчанию 1)
* Стоимость доставки (бесплатно/до определенной суммы/все равно)
* Максимальная стоимость заказа (обязательно ? (Если один человек можем предположить что наесться можно на 1000 р)

#####Ответ
-

#####Подводные камни/Идеи
* Алгоритм выбора ресторана и типа кухни - псевдорандом по mersenne twister (максимальная сумма заказа может влиять на выбор ресторана (эконом/элита))
* Алгоритм выбора блюд - сумма максимальная / количество персон / релевантность блюда(обязаны присутствовать суп второе горячее, а что делать если в меню только бургеры и пицца????)
* Как быть с ресторанами содержащими много кухонь?
* В разные районы может быть разная стоимость доставки.
* Кнопка - просто хочу пожрать без лишних настроек?


####OrderAPI
Доступен только после использования SearchAPI, занимается отправкой заказа на найденные блюда в службу доставки
#####Параметры запроса
-
#####Ответ
-


##Структура хранимых данных
###RDB
| Города         |
|----------------|
| ID:int         |
| Название:string|

| Районы городов |
|----------------|
| ID:int         |
| ID города:int  |
| Название:string|

| Службы доставки          |
|-----------------------   |
| ID:int                   |
| Название:string          |
| Стоимость доставки:double|
| Города:[ID города]       |

###Elastic
| Список блюд                         |
|--------------------------------------|
| Город:string                        |
| Служба доставки:string              |
| Районы доставки:[string]            |
| Стоимость доставки:double           |
| Интервал приема заказов:date(HH:mm)-date(HH:mm)   |
| Среднее время доставки:date(HH:mm)  |
| Название:string                     |
| Тип кухни:string                    |
| Стоимость:double                    |
| Вес порции:double                   |
| Описание блюда:string               |
| UUID изображения:string             |
| Тэги:[string]                       |

###Cassandra
| Картинки к блюдам |
|-------------------|
| UUID:string       |
| image:blob        |
